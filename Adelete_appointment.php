<?php
require('db.php');
// Assuming you have already established a database connection
$connection = new mysqli($servername, $dbusername, $dbpassword, $dbname);

// Check connection
if ($connection->connect_error) {
    die("Connection failed: " . $connection->connect_error);
}

// Get the ID of the appointment to delete from the POST request
$appointmentID = $_POST['id'];

// Prepare a statement to check if the appointment exists
$query = "SELECT * FROM appointments WHERE ID = ?";
$statement = $connection->prepare($query);
$statement->bind_param("i", $appointmentID);
$statement->execute();
$result = $statement->get_result();

// Check if the appointment exists
if ($result->num_rows > 0) {
    // Appointment exists, proceed with deletion
    $deleteQuery = "DELETE FROM appointments WHERE ID = ?";
    $deleteStatement = $connection->prepare($deleteQuery);
    $deleteStatement->bind_param("i", $appointmentID);
    if ($deleteStatement->execute()) {
        // Appointment deleted successfully
        $response = array("message" => "Appointment deleted successfully.");
    } else {
        // Failed to delete appointment
        $response = array("message" => "Failed to delete appointment.");
    }
} else {
    // Appointment with the provided ID does not exist
    $response = array("message" => "No appointment found with the provided ID. Please enter a correct ID.");
}


// Send response as JSON
echo json_encode($response);
$statement->close();
?>
